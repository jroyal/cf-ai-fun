<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>AI Prompt Question</title>
		<style>
			/* General Reset and Base Styles */
			* {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
			}

			body,
			html {
				height: 100%;
				font-family: 'Arial', sans-serif;
				background-color: #eceff1; /* Light grey background */
				display: flex;
				justify-content: center;
				align-items: center;
			}

			/* Main Content Card */
			.card {
				background-color: #fff;
				padding: 2rem;
				border-radius: 8px;
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
				width: 80%;
				max-width: 600px;
				margin: auto;
			}

			/* Input and Button Styles */
			.input-question {
				width: 100%;
				padding: 10px;
				border-radius: 4px;
				border: 1px solid #ddd;
				margin-bottom: 1rem; /* Space between input and button */
			}

			.compute-button {
				width: 100%;
				padding: 10px;
				border: none;
				border-radius: 4px;
				background-color: #007bff; /* Bootstrap primary color */
				color: white;
				cursor: pointer;
				font-size: 16px;
			}

			.compute-button:hover {
				background-color: #0056b3; /* Darker shade for hover state */
			}

			/* Answer Display Styles */
			.answer {
				margin-top: 1rem;
				padding: 10px;
				background-color: #f1f1f1; /* Light grey background */
				border-radius: 4px;
				border: 1px solid #ddd;
			}

			/* Spinner styles */
			.spinner {
				border: 4px solid rgba(0, 0, 0, 0.1);
				border-radius: 50%;
				border-top: 4px solid #3498db;
				width: 20px;
				height: 20px;
				animation: spin 1s linear infinite;
				position: absolute;
				left: 50%;
				top: 50%;
				transform: translate(-50%, -50%);
			}
			@keyframes spin {
				0% {
					transform: translate(-50%, -50%) rotate(0deg);
				}
				100% {
					transform: translate(-50%, -50%) rotate(360deg);
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<form id="questionForm">
				<input type="text" id="questionInput" placeholder="Ask your question here" autofocus />
				<button type="submit">Ask</button>
			</form>
			<div id="spinner" class="spinner" style="display: none"></div>
			<div id="answer"></div>
		</div>

		<script>
			function askQuestion() {
				var question = document.getElementById('questionInput').value;
				// Placeholder for making an API call to your Cloudflare Worker
				// For now, just display the question in the answer div
				document.getElementById('answer').innerText = 'Question asked: ' + question;
				var answerDiv = document.getElementById('answer');
				showSpinner(true);

				// answerDiv.innerHTML = '<div class="spinner"></div>'; // Show spinner while processing

				// Example: Fetch API call to Cloudflare Worker
				// fetch('/ai', {
				//     method: 'POST',
				//     headers: { 'Content-Type': 'application/json' },
				//     body: JSON.stringify({ question: question })
				// })
				// .then(response => response.json())
				// .then(data => {
				//     document.getElementById('answer').innerText = 'Answer: ' + data.answer;
				// })
				// .catch(error => console.error('Error:', error));

				const source = new EventSource('/ai?question=' + encodeURIComponent(question));
				source.onmessage = (event) => {
					if (event.data == '[DONE]') {
						source.close();
						showSpinner(false);
						console.log('done');
						return;
					}
					const data = JSON.parse(event.data);
					answerDiv.innerHTML += data.response;
				};
			}

			document.getElementById('questionForm').addEventListener('submit', function (event) {
				event.preventDefault();
				askQuestion();
			});

			function showSpinner(show) {
				const spinner = document.getElementById('spinner');
				spinner.style.display = show ? 'block' : 'none';
			}
		</script>
	</body>
</html>
